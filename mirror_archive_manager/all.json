{
  "meta": {
    "schema_version": 4,
    "id": "mirror_archive_manager",
    "name": "MirrorArchiveManager",
    "version": "0.1.4",
    "link": "https://github.com/Aimerny/MCDRPlugins/tree/main/src/mirror_archive_manager",
    "authors": [
      "Aimerny"
    ],
    "dependencies": {
      "mcdreforged": ">=2.12.0",
      "prime_backup": ">=1.7.4"
    },
    "requirements": [
      "mcdreforged>=2.12.0",
      "requests>=2.31.0",
      "fastapi>=0.111.1",
      "uvicorn>=0.31.0"
    ],
    "description": {
      "en_us": "A plugin for mirror server archive management based on prime_backup. Supports managing multiple mirror server archives",
      "zh_cn": "基于prime_backup的镜像服存档管理插件.支持管理多个镜像服存档"
    }
  },
  "plugin": {
    "schema_version": 1,
    "id": "mirror_archive_manager",
    "authors": [
      "Aimerny"
    ],
    "repository": "https://github.com/Aimerny/MCDRPlugins",
    "branch": "main",
    "related_path": "src/mirror_archive_manager",
    "labels": [
      "management"
    ],
    "introduction": {
      "en_us": "# MirrorArchiveManager\n\n一个基于Prime_Backup插件的支持管理多个镜像服务器的插件,支持存档同步,启停控制\n\n# 功能\n> [!IMPORTANT]\n> 该插件不会帮助你自动配置镜像服,请确保你已经配好了可以正常游玩的镜像服再使用本插件.\n\n**MirrorArchiveManager**插件借助[Prime Backup](https://github.com/TISUnion/PrimeBackup/tree/master)插件(以下简称\"pb\")强大的存档备份及回档机制,实现了以下功能\n1. 支持将主服选择pb的存档直接回档到镜像服\n2. 主服支持配置多个镜像服\n3. 主服可以通过指令直接控制镜像服的启停\n\n## 帮助指令\n\n```\n========== Mirror Archive Manager ==========\n!!mam start <server_name> -- 启动镜像服 <server_name>\n!!mam stop <server_name> -- 停止镜像服 <server_name>\n!!mam sync <server_name> <id> -- 将 prime_backup 中的编号#<id>的存档同步到<server_name>\n================ by Aimerny ================\n```\n\n## 依赖\n\n| python依赖项 | 版本       |\n| --------- | -------- |\n| requests  | ^2.31.0  |\n| fastapi   | ^0.111.1 |\n\n| mcdr依赖项      | 版本      |\n| ------------ | ------- |\n| mcdreforged  | ^2.12.x |\n| prime_backup | ^1.7.4  |\n\n# 使用说明\n在MirrorArchiveManager插件(以下简称`mam`)的视角里,服务器有两个角色,分别为`main`和`mirror`.\n如果你需要将`main`服务器的pb备份同步到`mirror`服务器,则需要进行一些小小的配置\n\n## 使用前配置\n\n### main服务器配置(未展示的配置无需配置)\n```json5\n{\n    // 需要设置为true\n    \"main\": true,\n    // 镜像服配置,可配置多个\n    \"mirrors\": [\n        {\n            // 镜像服务器名\n            \"name\": \"mirror\",\n            // 镜像服务器地址\n            \"host\": \"127.0.0.1\",\n            // 镜像服务器配置的端口(如下配置中设置了30076)\n            \"port\": 30076\n        }\n    ],\n    // 指令的MCDR权限等级\n    \"perms\": {\n        \"start\": 3,\n        \"stop\": 3,\n        \"sync\": 3\n    }\n}\n```\n\n### mirror服务器配置(未展示的配置无需配置)\n```json5\n{\n    // 需要设置为false\n    \"main\": false,\n    // 主服的相对路径或绝对路径\n    \"main_path\": \"../main\",\n    // 控制端口\n    \"port\": 30076\n}\n```\n### 启动主服+镜像服\n启动后你会在主服看到如下日志:\n```\n[MCDR] [03:01:41] [TaskExecutor/INFO] [mirror_archive_manager]: MAM running with main role!\n[MCDR] [03:01:41] [TaskExecutor/INFO] [mirror_archive_manager]: MirrorArchiveManager initialization completed!\n```\n在镜像服会看到如下日志:\n```\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: MAM running with mirror role!\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: mirror http server started...\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: mirror process...\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: MirrorArchiveManager initialization completed!\n```\n此时插件便加载成功了.\n\n## 启停镜像服\n> [!IMPORTANT]\n> 虽然该插件具有启停镜像服功能,但是要求镜像服处于MCDR进程启动的状态.换而言之,只有通过mam停止的镜像服才能再通过mam启动\n### 停止\n`!!mam stop <server_name>`: `server_name`非必填,如果没填会用第一个已配置的镜像服\n### 启动\n`!!mam start <server_name>`: `server_name`非必填,如果没填会用第一个已配置的镜像服\n\n## 指定备份存档同步到镜像服\n`!!mam sync <id> <server_name>`\n1. `server_name`非必填,如果没填会用第一个已配置的镜像服\n2. `id`为pb备份id,**必填**\n\n# 配置详解\n| 配置             | 说明                              | 示例                              |\n| -------------- | ------------------------------- | ------------------------------- |\n| main           | 是否是主服角色,必填                      | true                            |\n| mirrors        | 镜像服配置,主服必填                      | []                              |\n| mirrors[].name | 主服操作镜像时的名称,必填且唯一                | mirror                          |\n| mirrors[].host | 主服连接镜像时的地址,必填                   | 127.0.0.1                       |\n| mirrors[].port | 主服连接镜像时访问端口,必填                  | 30076                           |\n| main_path      | 镜像服相对主服的文件夹的相对路径或者主服的绝对路径,镜像服必填 | ../main 或者 /Users/aim/mcdr/main |\n| port           | 镜像服被主服访问的端口,镜像服必填               | 30076                           |\n| perms          | 指令操作权限等级,使用MCDR的权限等级,主服必填       | 3                               |\n",
      "zh_cn": "# MirrorArchiveManager\n\n一个基于Prime_Backup插件的支持管理多个镜像服务器的插件,支持存档同步,启停控制\n\n# 功能\n> [!IMPORTANT]\n> 该插件不会帮助你自动配置镜像服,请确保你已经配好了可以正常游玩的镜像服再使用本插件.\n\n**MirrorArchiveManager**插件借助[Prime Backup]()插件(以下简称\"pb\")强大的存档备份及回档机制,实现了以下功能\n1. 支持将主服选择pb的存档直接回档到镜像服\n2. 主服支持配置多个镜像服\n3. 主服可以通过指令直接控制镜像服的启停\n\n## 帮助指令\n\n```\n========== Mirror Archive Manager ==========\n!!mam start <server_name> -- 启动镜像服 <server_name>\n!!mam stop <server_name> -- 停止镜像服 <server_name>\n!!mam sync <server_name> <id> -- 将 prime_backup 中的编号#<id>的存档同步到<server_name>\n================ by Aimerny ================\n```\n\n## 依赖\n\n| python依赖项 | 版本       |\n| --------- | -------- |\n| requests  | ^2.31.0  |\n| fastapi   | ^0.111.1 |\n\n| mcdr依赖项      | 版本      |\n| ------------ | ------- |\n| mcdreforged  | ^2.12.x |\n| prime_backup | ^1.7.4  |\n\n# 使用说明\n在MirrorArchiveManager插件(以下简称`mam`)的视角里,服务器有两个角色,分别为`main`和`mirror`.\n如果你需要将`main`服务器的pb备份同步到`mirror`服务器,则需要进行一些小小的配置\n\n## 使用前配置\n\n### main服务器配置(未展示的配置无需配置)\n```json5\n{\n    // 需要设置为true\n    \"main\": true,\n    // 镜像服配置,可配置多个\n    \"mirrors\": [\n        {\n            // 镜像服务器名\n            \"name\": \"mirror\",\n            // 镜像服务器地址\n            \"host\": \"127.0.0.1\",\n            // 镜像服务器配置的端口(如下配置中设置了30076)\n            \"port\": 30076\n        }\n    ],\n    // 指令的MCDR权限等级\n    \"perms\": {\n        \"start\": 3,\n        \"stop\": 3,\n        \"sync\": 3\n    }\n}\n```\n\n### mirror服务器配置(未展示的配置无需配置)\n```json5\n{\n    // 需要设置为false\n    \"main\": false,\n    // 主服的相对路径或绝对路径\n    \"main_path\": \"../main\",\n    // 控制端口\n    \"port\": 30076\n}\n```\n### 启动主服+镜像服\n启动后你会在主服看到如下日志:\n```\n[MCDR] [03:01:41] [TaskExecutor/INFO] [mirror_archive_manager]: MAM running with main role!\n[MCDR] [03:01:41] [TaskExecutor/INFO] [mirror_archive_manager]: MirrorArchiveManager initialization completed!\n```\n在镜像服会看到如下日志:\n```\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: MAM running with mirror role!\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: mirror http server started...\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: mirror process...\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: MirrorArchiveManager initialization completed!\n```\n此时插件便加载成功了.\n\n## 启停镜像服\n> [!IMPORTANT]\n> 虽然该插件具有启停镜像服功能,但是要求镜像服处于MCDR进程启动的状态.换而言之,只有通过mam停止的镜像服才能再通过mam启动\n### 停止\n`!!mam stop <server_name>`: `server_name`非必填,如果没填会用第一个已配置的镜像服\n### 启动\n`!!mam start <server_name>`: `server_name`非必填,如果没填会用第一个已配置的镜像服\n\n## 指定备份存档同步到镜像服\n`!!mam sync <id> <server_name>`\n1. `server_name`非必填,如果没填会用第一个已配置的镜像服\n2. `id`为pb备份id,**必填**\n\n# 配置详解\n| 配置             | 说明                              | 示例                              |\n| -------------- | ------------------------------- | ------------------------------- |\n| main           | 是否是主服角色,必填                      | true                            |\n| mirrors        | 镜像服配置,主服必填                      | []                              |\n| mirrors[].name | 主服操作镜像时的名称,必填且唯一                | mirror                          |\n| mirrors[].host | 主服连接镜像时的地址,必填                   | 127.0.0.1                       |\n| mirrors[].port | 主服连接镜像时访问端口,必填                  | 30076                           |\n| main_path      | 镜像服相对主服的文件夹的相对路径或者主服的绝对路径,镜像服必填 | ../main 或者 /Users/aim/mcdr/main |\n| port           | 镜像服被主服访问的端口,镜像服必填               | 30076                           |\n| perms          | 指令操作权限等级,使用MCDR的权限等级,主服必填       | 3                               |\n"
    },
    "introduction_urls": {
      "en_us": "https://raw.githubusercontent.com/Aimerny/MCDRPlugins/main/src/mirror_archive_manager/README.md",
      "zh_cn": "https://raw.githubusercontent.com/Aimerny/MCDRPlugins/main/src/mirror_archive_manager/README_ZH.md"
    }
  },
  "release": {
    "schema_version": 8,
    "id": "mirror_archive_manager",
    "latest_version": "0.1.4",
    "latest_version_index": 0,
    "releases": [
      {
        "url": "https://github.com/Aimerny/MCDRPlugins/releases/tag/mirror_archive_manager-v0.1.4",
        "name": "mirror_archive_manager: v0.1.4",
        "tag_name": "mirror_archive_manager-v0.1.4",
        "created_at": "2025-02-06T07:04:22Z",
        "description": "## [0.1.4](https://github.com/Aimerny/MCDRPlugins/compare/mirror_archive_manager-v0.1.3...mirror_archive_manager-v0.1.4) (2025-02-06)\n\n\n### Bug Fixes\n\n* fix link for all plugins meta ([c313e6f](https://github.com/Aimerny/MCDRPlugins/commit/c313e6f1b92db0c76a200c4c25956adfb4c4c933))",
        "prerelease": false,
        "asset": {
          "id": 226767251,
          "name": "MirrorArchiveManager-v0.1.4.mcdr",
          "size": 12223,
          "download_count": 246,
          "created_at": "2025-02-06T07:05:04Z",
          "browser_download_url": "https://github.com/Aimerny/MCDRPlugins/releases/download/mirror_archive_manager-v0.1.4/MirrorArchiveManager-v0.1.4.mcdr",
          "hash_md5": "1ed75fb2a465fbbe0d52aa9893aa0901",
          "hash_sha256": "a925c8865c0ae3b0051d5f863d7999c858e4c1c27e3c8f52bfa48e5bde1ede40"
        },
        "meta": {
          "schema_version": 4,
          "id": "mirror_archive_manager",
          "name": "MirrorArchiveManager",
          "version": "0.1.4",
          "link": "https://github.com/Aimerny/MCDRPlugins/tree/main/src/mirror_archive_manager",
          "authors": [
            "Aimerny"
          ],
          "dependencies": {
            "mcdreforged": ">=2.12.0",
            "prime_backup": ">=1.7.4"
          },
          "requirements": [
            "mcdreforged>=2.12.0",
            "requests>=2.31.0",
            "fastapi>=0.111.1",
            "uvicorn>=0.31.0"
          ],
          "description": {
            "en_us": "A plugin for mirror server archive management based on prime_backup. Supports managing multiple mirror server archives",
            "zh_cn": "基于prime_backup的镜像服存档管理插件.支持管理多个镜像服存档"
          }
        }
      },
      {
        "url": "https://github.com/Aimerny/MCDRPlugins/releases/tag/mirror_archive_manager-v0.1.3",
        "name": "mirror_archive_manager: v0.1.3",
        "tag_name": "mirror_archive_manager-v0.1.3",
        "created_at": "2024-12-20T07:04:05Z",
        "description": "## [0.1.3](https://github.com/Aimerny/MCDRPlugins/compare/mirror_archive_manager-v0.1.2...mirror_archive_manager-v0.1.3) (2024-12-20)\r\n\r\n\r\n### Bug Fixes\r\n\r\n* **mam:** Remove the ‘|’ grammar usage, and adapt it for a version lower than Python 3.10.” ([299a2ea](https://github.com/Aimerny/MCDRPlugins/commit/299a2ea9274957ba273e8aee0f2a85859b80c986))",
        "prerelease": false,
        "asset": {
          "id": 214651752,
          "name": "MirrorArchiveManager-v0.1.3.mcdr",
          "size": 12197,
          "download_count": 95,
          "created_at": "2024-12-20T07:04:52Z",
          "browser_download_url": "https://github.com/Aimerny/MCDRPlugins/releases/download/mirror_archive_manager-v0.1.3/MirrorArchiveManager-v0.1.3.mcdr",
          "hash_md5": "b1382e3212f2ededbb20a9a0badc696e",
          "hash_sha256": "ba174028e1add5e5e991f63d2afd5cef885e7d1379e65e52f85e84b875a780c4"
        },
        "meta": {
          "schema_version": 4,
          "id": "mirror_archive_manager",
          "name": "MirrorArchiveManager",
          "version": "0.1.3",
          "link": "https://github.com/Aimerny/MirrorArchiveManager",
          "authors": [
            "Aimerny"
          ],
          "dependencies": {
            "mcdreforged": ">=2.12.0",
            "prime_backup": ">=1.7.4"
          },
          "requirements": [
            "mcdreforged>=2.12.0",
            "requests>=2.31.0",
            "fastapi>=0.111.1",
            "uvicorn>=0.31.0"
          ],
          "description": {
            "en_us": "A plugin for mirror server archive management based on prime_backup. Supports managing multiple mirror server archives",
            "zh_cn": "基于prime_backup的镜像服存档管理插件.支持管理多个镜像服存档"
          }
        }
      },
      {
        "url": "https://github.com/Aimerny/MCDRPlugins/releases/tag/mirror_archive_manager-v0.1.2",
        "name": "mirror_archive_manager: v0.1.2",
        "tag_name": "mirror_archive_manager-v0.1.2",
        "created_at": "2024-09-29T07:14:35Z",
        "description": "## [0.1.2](https://github.com/Aimerny/MCDRPlugins/compare/mirror_archive_manager-v0.1.1...mirror_archive_manager-v0.1.2) (2024-09-29)\n\n\n### Bug Fixes\n\n* **mam:** :bug: skip load mam if pb is disabled ([4a63d12](https://github.com/Aimerny/MCDRPlugins/commit/4a63d127631ac8e6d900292accef9b323b2587f4))",
        "prerelease": false,
        "asset": {
          "id": 195659188,
          "name": "MirrorArchiveManager-v0.1.2.mcdr",
          "size": 12189,
          "download_count": 60,
          "created_at": "2024-09-29T07:15:11Z",
          "browser_download_url": "https://github.com/Aimerny/MCDRPlugins/releases/download/mirror_archive_manager-v0.1.2/MirrorArchiveManager-v0.1.2.mcdr",
          "hash_md5": "c52c739e9abda053ff9f6775ad92f8db",
          "hash_sha256": "2e8b3d3fcf7a44c19faccac192b6859394f0227df9b86266418e13b25142394f"
        },
        "meta": {
          "schema_version": 4,
          "id": "mirror_archive_manager",
          "name": "MirrorArchiveManager",
          "version": "0.1.2",
          "link": "https://github.com/Aimerny/MirrorArchiveManager",
          "authors": [
            "Aimerny"
          ],
          "dependencies": {
            "mcdreforged": ">=2.12.0",
            "prime_backup": ">=1.7.4"
          },
          "requirements": [
            "mcdreforged>=2.12.0",
            "requests>=2.31.0",
            "fastapi>=0.111.1",
            "uvicorn>=0.31.0"
          ],
          "description": {
            "en_us": "A plugin for mirror server archive management based on prime_backup. Supports managing multiple mirror server archives",
            "zh_cn": "基于prime_backup的镜像服存档管理插件.支持管理多个镜像服存档"
          }
        }
      },
      {
        "url": "https://github.com/Aimerny/MCDRPlugins/releases/tag/mirror_archive_manager-v0.1.1",
        "name": "mirror_archive_manager: v0.1.1",
        "tag_name": "mirror_archive_manager-v0.1.1",
        "created_at": "2024-09-29T03:30:46Z",
        "description": "## [0.1.1](https://github.com/Aimerny/MCDRPlugins/compare/mirror_archive_manager-v0.1.0...mirror_archive_manager-v0.1.1) (2024-09-29)\n\n\n### Bug Fixes\n\n* **mam:** :bug: add dependecy 'uvicorn' ([df2386d](https://github.com/Aimerny/MCDRPlugins/commit/df2386d2af9685f66009c21fc5d5608820dab9f1))",
        "prerelease": false,
        "asset": {
          "id": 195640656,
          "name": "MirrorArchiveManager-v0.1.1.mcdr",
          "size": 12130,
          "download_count": 28,
          "created_at": "2024-09-29T03:31:27Z",
          "browser_download_url": "https://github.com/Aimerny/MCDRPlugins/releases/download/mirror_archive_manager-v0.1.1/MirrorArchiveManager-v0.1.1.mcdr",
          "hash_md5": "6ffc1819d1b183fbd4f14fa3e1c0dc5b",
          "hash_sha256": "3da56c17f92159dc8b99172fc05cc2cbe49f7e83820bf756be2e6f78ff8fb133"
        },
        "meta": {
          "schema_version": 4,
          "id": "mirror_archive_manager",
          "name": "MirrorArchiveManager",
          "version": "0.1.1",
          "link": "https://github.com/Aimerny/MirrorArchiveManager",
          "authors": [
            "Aimerny"
          ],
          "dependencies": {
            "mcdreforged": ">=2.12.0",
            "prime_backup": ">=1.7.4"
          },
          "requirements": [
            "mcdreforged>=2.12.0",
            "requests>=2.31.0",
            "fastapi>=0.111.1",
            "uvicorn>=0.31.0"
          ],
          "description": {
            "en_us": "A plugin for mirror server archive management based on prime_backup. Supports managing multiple mirror server archives",
            "zh_cn": "基于prime_backup的镜像服存档管理插件.支持管理多个镜像服存档"
          }
        }
      },
      {
        "url": "https://github.com/Aimerny/MCDRPlugins/releases/tag/mirror_archive_manager-v0.1.0",
        "name": "MirrorArchiveManager: v0.1.0",
        "tag_name": "mirror_archive_manager-v0.1.0",
        "created_at": "2024-08-28T17:59:05Z",
        "description": "## [0.1.0](https://github.com/Aimerny/MCDRPlugins/compare/MirrorArchiveManager-v0.0.2...MirrorArchiveManager-v0.1.0) (2024-08-28)\r\n\r\n\r\n### Features\r\n\r\n* :tada: init exist plugins ([5029f43](https://github.com/Aimerny/MCDRPlugins/commit/5029f430f3a376878270a08124a73cad63af7bc5))\r\n\r\n\r\n### Bug Fixes\r\n\r\n* **mirror_archive_manager:** :bug: help message optimize ([0d9855b](https://github.com/Aimerny/MCDRPlugins/commit/0d9855b49376c8aae23e26d44ddd0e5a187dd40a))\r\n* **mirror_archive_manager:** :fire: reset version ([a2cd79b](https://github.com/Aimerny/MCDRPlugins/commit/a2cd79b68ec21b18f61c0fdce0dbd6c656be80a0))",
        "prerelease": false,
        "asset": {
          "id": 188909901,
          "name": "MirrorArchiveManager-v0.1.0.mcdr",
          "size": 12120,
          "download_count": 47,
          "created_at": "2024-08-28T17:59:38Z",
          "browser_download_url": "https://github.com/Aimerny/MCDRPlugins/releases/download/mirror_archive_manager-v0.1.0/MirrorArchiveManager-v0.1.0.mcdr",
          "hash_md5": "b3ebcbd9e68e67f8ec9d7db7f207bd9c",
          "hash_sha256": "7b54a85c6442b6f609f74a7788d0acbd9ddef8cc4198e92f3b70d8ebbc9a6a98"
        },
        "meta": {
          "schema_version": 4,
          "id": "mirror_archive_manager",
          "name": "MirrorArchiveManager",
          "version": "0.1.0",
          "link": "https://github.com/Aimerny/MirrorArchiveManager",
          "authors": [
            "Aimerny"
          ],
          "dependencies": {
            "mcdreforged": ">=2.12.0",
            "prime_backup": ">=1.7.4"
          },
          "requirements": [
            "mcdreforged>=2.12.0",
            "requests>=2.31.0",
            "fastapi>=0.111.1"
          ],
          "description": {
            "en_us": "A plugin for mirror server archive management based on prime_backup. Supports managing multiple mirror server archives",
            "zh_cn": "基于prime_backup的镜像服存档管理插件.支持管理多个镜像服存档"
          }
        }
      }
    ]
  },
  "repository": {
    "url": "https://github.com/Aimerny/MCDRPlugins",
    "name": "MCDRPlugins",
    "full_name": "Aimerny/MCDRPlugins",
    "html_url": "https://github.com/Aimerny/MCDRPlugins",
    "description": "Aimerny's MCDR plugins repository",
    "archived": false,
    "stargazers_count": 7,
    "watchers_count": 7,
    "forks_count": 1,
    "readme": "# MirrorArchiveManager\n\n一个基于Prime_Backup插件的支持管理多个镜像服务器的插件,支持存档同步,启停控制\n\n# 功能\n> [!IMPORTANT]\n> 该插件不会帮助你自动配置镜像服,请确保你已经配好了可以正常游玩的镜像服再使用本插件.\n\n**MirrorArchiveManager**插件借助[Prime Backup](https://github.com/TISUnion/PrimeBackup/tree/master)插件(以下简称\"pb\")强大的存档备份及回档机制,实现了以下功能\n1. 支持将主服选择pb的存档直接回档到镜像服\n2. 主服支持配置多个镜像服\n3. 主服可以通过指令直接控制镜像服的启停\n\n## 帮助指令\n\n```\n========== Mirror Archive Manager ==========\n!!mam start <server_name> -- 启动镜像服 <server_name>\n!!mam stop <server_name> -- 停止镜像服 <server_name>\n!!mam sync <server_name> <id> -- 将 prime_backup 中的编号#<id>的存档同步到<server_name>\n================ by Aimerny ================\n```\n\n## 依赖\n\n| python依赖项 | 版本       |\n| --------- | -------- |\n| requests  | ^2.31.0  |\n| fastapi   | ^0.111.1 |\n\n| mcdr依赖项      | 版本      |\n| ------------ | ------- |\n| mcdreforged  | ^2.12.x |\n| prime_backup | ^1.7.4  |\n\n# 使用说明\n在MirrorArchiveManager插件(以下简称`mam`)的视角里,服务器有两个角色,分别为`main`和`mirror`.\n如果你需要将`main`服务器的pb备份同步到`mirror`服务器,则需要进行一些小小的配置\n\n## 使用前配置\n\n### main服务器配置(未展示的配置无需配置)\n```json5\n{\n    // 需要设置为true\n    \"main\": true,\n    // 镜像服配置,可配置多个\n    \"mirrors\": [\n        {\n            // 镜像服务器名\n            \"name\": \"mirror\",\n            // 镜像服务器地址\n            \"host\": \"127.0.0.1\",\n            // 镜像服务器配置的端口(如下配置中设置了30076)\n            \"port\": 30076\n        }\n    ],\n    // 指令的MCDR权限等级\n    \"perms\": {\n        \"start\": 3,\n        \"stop\": 3,\n        \"sync\": 3\n    }\n}\n```\n\n### mirror服务器配置(未展示的配置无需配置)\n```json5\n{\n    // 需要设置为false\n    \"main\": false,\n    // 主服的相对路径或绝对路径\n    \"main_path\": \"../main\",\n    // 控制端口\n    \"port\": 30076\n}\n```\n### 启动主服+镜像服\n启动后你会在主服看到如下日志:\n```\n[MCDR] [03:01:41] [TaskExecutor/INFO] [mirror_archive_manager]: MAM running with main role!\n[MCDR] [03:01:41] [TaskExecutor/INFO] [mirror_archive_manager]: MirrorArchiveManager initialization completed!\n```\n在镜像服会看到如下日志:\n```\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: MAM running with mirror role!\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: mirror http server started...\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: mirror process...\n[MCDR] [03:07:04] [TaskExecutor/INFO] [mirror_archive_manager]: MirrorArchiveManager initialization completed!\n```\n此时插件便加载成功了.\n\n## 启停镜像服\n> [!IMPORTANT]\n> 虽然该插件具有启停镜像服功能,但是要求镜像服处于MCDR进程启动的状态.换而言之,只有通过mam停止的镜像服才能再通过mam启动\n### 停止\n`!!mam stop <server_name>`: `server_name`非必填,如果没填会用第一个已配置的镜像服\n### 启动\n`!!mam start <server_name>`: `server_name`非必填,如果没填会用第一个已配置的镜像服\n\n## 指定备份存档同步到镜像服\n`!!mam sync <id> <server_name>`\n1. `server_name`非必填,如果没填会用第一个已配置的镜像服\n2. `id`为pb备份id,**必填**\n\n# 配置详解\n| 配置             | 说明                              | 示例                              |\n| -------------- | ------------------------------- | ------------------------------- |\n| main           | 是否是主服角色,必填                      | true                            |\n| mirrors        | 镜像服配置,主服必填                      | []                              |\n| mirrors[].name | 主服操作镜像时的名称,必填且唯一                | mirror                          |\n| mirrors[].host | 主服连接镜像时的地址,必填                   | 127.0.0.1                       |\n| mirrors[].port | 主服连接镜像时访问端口,必填                  | 30076                           |\n| main_path      | 镜像服相对主服的文件夹的相对路径或者主服的绝对路径,镜像服必填 | ../main 或者 /Users/aim/mcdr/main |\n| port           | 镜像服被主服访问的端口,镜像服必填               | 30076                           |\n| perms          | 指令操作权限等级,使用MCDR的权限等级,主服必填       | 3                               |\n",
    "readme_url": "https://raw.githubusercontent.com/Aimerny/MCDRPlugins/main/src/mirror_archive_manager/README.md",
    "license": {
      "key": "gpl-3.0",
      "name": "GNU General Public License v3.0",
      "spdx_id": "GPL-3.0",
      "url": "https://api.github.com/licenses/gpl-3.0"
    }
  }
}