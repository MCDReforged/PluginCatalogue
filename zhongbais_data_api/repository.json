{
  "url": "https://github.com/zhongbai2333/zhongbais-Data-API",
  "name": "zhongbais-Data-API",
  "full_name": "zhongbai2333/zhongbais-Data-API",
  "html_url": "https://github.com/zhongbai2333/zhongbais-Data-API",
  "description": "Polling /data command related APIs",
  "archived": false,
  "stargazers_count": 1,
  "watchers_count": 1,
  "forks_count": 0,
  "readme": "# zhongbais Data API\n\nA MCDReforged–based player position retrieval and callback API. It encapsulates timed polling and callback mechanisms, making it easy for other plugins or scripts to uniformly access and subscribe to changes in player position, dimension, rotation, and more.\n\nEnglish | [简中](https://github.com/zhongbai2333/zhongbais-Data-API/tree/main/README_zh.md)\n\n---\n\n## Features\n\n- **Timed Polling**: Automatically polls all online players’ NBT data via RCON at the configured interval\n- **Callback System**: Built-in lists of callbacks let you subscribe to specific NBT fields or to player list changes\n\n---\n\n## Quick Start\n\n```python\nfrom mcdreforged.api.all import PluginServerInterface, new_thread\nfrom zhongbais_data_api import zbDataAPI\n\ndef on_load(self, server: PluginServerInterface, old):\n    # Listen for *all* NBT changes\n    zbDataAPI.register_player_info_callback(self.on_player_update)\n    # Or listen for specific NBT fields only:\n    # zbDataAPI.register_player_info_callback(self.on_player_update, ['Pos', 'Dimension', ...])\n\n    # Listen for player join/leave events\n    zbDataAPI.register_player_list_callback(self.on_player_list_change)\n\ndef on_player_update(self, name: str, info: dict):\n    \"\"\"\n    name: player’s name\n    info: {\n      \"Pos\": [...],         # position [x, y, z]\n      \"Rotation\": [...],    # rotation [yaw, pitch]\n      \"Dimension\": \"...\",   # dimension\n      …                     # other fields as configured\n    }\n    \"\"\"\n    self.server.logger.info(f\"[PlayerUpdate] {name} -> {info}\")\n\ndef on_player_list_change(self, player: str, current_list: list):\n    # player: name of the player who joined or left\n    # current_list: list of all online players\n    self.server.logger.info(f\"[PlayerList] {player} changed, now: {current_list}\")\n\n# Manually trigger a data fetch (e.g. for testing)\nzbDataAPI.refresh_getpos()\n```\n\n---\n\n## Configuration\n\nOnly the bot detection related config is listed here; others can stay at their defaults:\n\n- bot_keyword (bot keyword)\n  - Used to detect and ignore bot player names.\n  - Supports glob-style wildcards: `*`, `?`, `[]`.\n  - If no wildcard is present, falls back to substring check (backward compatible with older versions).\n  - Matching is case-insensitive.\n  - Examples:\n    - `bot_*`: matches names starting with `bot_`, e.g., `bot_alice`.\n    - `*_bot`: matches names ending with `_bot`, e.g., `helper_bot`.\n    - `Bot??Bot*`: matches `Bot` + any two chars + `Bot` + any suffix, e.g., `Bot12BotX`, `BotA3Bot_something`.\n\n> Tip: To keep the old behavior where any name containing `bot_` is treated as a bot, set it to `bot_` (without wildcards).\n\n---\n\n## API Documentation\n\n### `zbDataAPI.register_player_info_callback(func, list=[]) -> None`\n\nAutomatically delivers NBT data (position, dimension, rotation, etc.) for players.\nIf `list` is empty (default), listens to *all* players; otherwise, only to the specified NBT fields.\n\n> **Parameters**\n> \n> - `func(name: str, info: dict)`: callback function; `name` is the player’s name, `info` is a dict of the latest data.\n> - `list: list` (optional): list of NBT field names to listen for, default `[]`.\n\n---\n\n### `zbDataAPI.get_player_list() -> list`\n\nReturns the list of currently online player names.\n\n```python\nplayers = zbDataAPI.get_player_list()\n```\n\n---\n\n### `zbDataAPI.register_player_list_callback(func) -> None`\n\nTriggered when a player joins or leaves.\n\n> **Parameters**\n> \n> - `func(player: str, current_list: list)`: callback function; `player` is the name of the joined/left player, `current_list` is the updated list of online players.\n\n---\n\n### `zbDataAPI.refresh_getpos() -> None`\n\nManually triggers a data fetch, equivalent to the internal timed polling.\n\n---\n\n## Development & Contribution\n\n1. Fork this repository\n2. Create a branch `feature/xxx`\n3. Commit your changes and open a Pull Request\n\nContributions, issues, and PRs are welcome to make this API even better!\n\n---\n\n## License\n\nThis project is licensed under GPLv3. See [LICENSE](https://github.com/zhongbai2333/zhongbais-Data-API/tree/main/./LICENSE) for details.\n",
  "readme_url": "https://raw.githubusercontent.com/zhongbai2333/zhongbais-Data-API/main/README.md",
  "license": {
    "key": "gpl-3.0",
    "name": "GNU General Public License v3.0",
    "spdx_id": "GPL-3.0",
    "url": "https://api.github.com/licenses/gpl-3.0"
  }
}