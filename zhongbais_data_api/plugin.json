{
  "schema_version": 1,
  "id": "zhongbais_data_api",
  "authors": [
    "zhongbai233"
  ],
  "repository": "https://github.com/zhongbai2333/zhongbais-Data-API",
  "branch": "main",
  "related_path": ".",
  "labels": [
    "api"
  ],
  "introduction": {
    "en_us": "# zhongbais Data API\n\nA MCDReforged–based player position retrieval and callback API. It encapsulates timed polling and callback mechanisms, making it easy for other plugins or scripts to uniformly access and subscribe to changes in player position, dimension, rotation, and more.\n\nEnglish | [简中](https://github.com/zhongbai2333/zhongbais-Data-API/tree/main/README_zh.md)\n\n---\n\n## Features\n\n- **Timed Polling**: Automatically polls all online players’ NBT data via RCON at the configured interval\n- **Callback System**: Built-in lists of callbacks let you subscribe to specific NBT fields or to player list changes\n\n---\n\n## Quick Start\n\n```python\nfrom mcdreforged.api.all import PluginServerInterface, new_thread\nfrom zhongbais_data_api import zbDataAPI\n\ndef on_load(self, server: PluginServerInterface, old):\n    # Listen for *all* NBT changes\n    zbDataAPI.register_player_info_callback(self.on_player_update)\n    # Or listen for specific NBT fields only:\n    # zbDataAPI.register_player_info_callback(self.on_player_update, ['Pos', 'Dimension', ...])\n\n    # Listen for player join/leave events\n    zbDataAPI.register_player_list_callback(self.on_player_list_change)\n\ndef on_player_update(self, name: str, info: dict):\n    \"\"\"\n    name: player’s name\n    info: {\n      \"Pos\": [...],         # position [x, y, z]\n      \"Rotation\": [...],    # rotation [yaw, pitch]\n      \"Dimension\": \"...\",   # dimension\n      …                     # other fields as configured\n    }\n    \"\"\"\n    self.server.logger.info(f\"[PlayerUpdate] {name} -> {info}\")\n\ndef on_player_list_change(self, player: str, current_list: list):\n    # player: name of the player who joined or left\n    # current_list: list of all online players\n    self.server.logger.info(f\"[PlayerList] {player} changed, now: {current_list}\")\n\n# Manually trigger a data fetch (e.g. for testing)\nzbDataAPI.refresh_getpos()\n```\n\n---\n\n## Configuration\n\nOnly the bot detection related config is listed here; others can stay at their defaults:\n\n- bot_keyword (bot keyword)\n  - Used to detect and ignore bot player names.\n  - Supports glob-style wildcards: `*`, `?`, `[]`.\n  - If no wildcard is present, falls back to substring check (backward compatible with older versions).\n  - Matching is case-insensitive.\n  - Examples:\n    - `bot_*`: matches names starting with `bot_`, e.g., `bot_alice`.\n    - `*_bot`: matches names ending with `_bot`, e.g., `helper_bot`.\n    - `Bot??Bot*`: matches `Bot` + any two chars + `Bot` + any suffix, e.g., `Bot12BotX`, `BotA3Bot_something`.\n\n> Tip: To keep the old behavior where any name containing `bot_` is treated as a bot, set it to `bot_` (without wildcards).\n\n---\n\n## API Documentation\n\n### `zbDataAPI.register_player_info_callback(func, list=[]) -> None`\n\nAutomatically delivers NBT data (position, dimension, rotation, etc.) for players.\nIf `list` is empty (default), listens to *all* players; otherwise, only to the specified NBT fields.\n\n> **Parameters**\n> \n> - `func(name: str, info: dict)`: callback function; `name` is the player’s name, `info` is a dict of the latest data.\n> - `list: list` (optional): list of NBT field names to listen for, default `[]`.\n\n---\n\n### `zbDataAPI.get_player_list() -> list`\n\nReturns the list of currently online player names.\n\n```python\nplayers = zbDataAPI.get_player_list()\n```\n\n---\n\n### `zbDataAPI.register_player_list_callback(func) -> None`\n\nTriggered when a player joins or leaves.\n\n> **Parameters**\n> \n> - `func(player: str, current_list: list)`: callback function; `player` is the name of the joined/left player, `current_list` is the updated list of online players.\n\n---\n\n### `zbDataAPI.refresh_getpos() -> None`\n\nManually triggers a data fetch, equivalent to the internal timed polling.\n\n---\n\n## Development & Contribution\n\n1. Fork this repository\n2. Create a branch `feature/xxx`\n3. Commit your changes and open a Pull Request\n\nContributions, issues, and PRs are welcome to make this API even better!\n\n---\n\n## License\n\nThis project is licensed under GPLv3. See [LICENSE](https://github.com/zhongbai2333/zhongbais-Data-API/tree/main/./LICENSE) for details.\n",
    "zh_cn": "# zhongbais Data API\n\n一个基于 MCDReforged 的玩家位置信息获取与回调 API，封装了定时拉取等功能，方便其他插件或脚本统一访问和订阅玩家位置、维度、朝向等数据变化。\n\n[English](https://github.com/zhongbai2333/zhongbais-Data-API/tree/main/README.md) | 简中\n\n---\n\n## 特性\n\n- **定时拉取**：自动按配置的间隔通过 RCON 获取所有在线玩家的 NBT 数据\n- **回调机制**：封装了回调列表，支持按需订阅玩家信息变化或在线列表增减\n\n---\n\n## 快速上手\n\n```python\nfrom mcdreforged.api.all import PluginServerInterface, new_thread\nfrom zhongbais_data_api import zbDataAPI\n\ndef on_load(self, server: PluginServerInterface, old):\n    # 监听所有NBT的信息变化\n    zbDataAPI.register_player_info_callback(self.on_player_update)\n    # 也可以只监听部分NBT的信息变化\n    # zbDataAPI.register_player_info_callback(self.on_player_update, ['Pos', 'Dimension', ...])\n\n    # 监听在线玩家列表变化\n    zbDataAPI.register_player_list_callback(self.on_player_list_change)\n\ndef on_player_update(self, name: str, info: dict):\n    \"\"\"\n    name: 玩家名\n    info: {\n      \"Pos\": [...],         # 位置 [x, y, z]\n      \"Rotation\": [...],    # 朝向 [yaw, pitch]\n      \"Dimension\": \"...\",   # 维度\n      …                     # 可根据配置添加其他字段\n    }\n    \"\"\"\n    self.server.logger.info(f\"[PlayerUpdate] {name} -> {info}\")\n\ndef on_player_list_change(self, player: str, current_list: list):\n    # player: 新增或离线的玩家名\n    # current_list: 当前所有在线玩家列表\n    self.server.logger.info(f\"[PlayerList] {player} changed, now: {current_list}\")\n\n# 在需要时手动触发一次拉取（例如测试时）\nzbDataAPI.refresh_getpos()\n```\n\n---\n\n## 配置说明\n\n以下仅列出与“机器人玩家识别”相关的配置项，其他保持默认即可：\n\n- bot_keyword（机器人过滤关键字）\n  - 用于识别并忽略机器人玩家名。\n  - 支持通配符（glob）匹配：`*`, `?`, `[]`。\n  - 若不包含通配符，则按“子串包含”判断（与旧版本一致）。\n  - 匹配不区分大小写。\n  - 示例：\n    - `bot_*`：匹配以 `bot_` 开头的名字，如 `bot_alice`。\n    - `*_bot`：匹配以 `_bot` 结尾的名字，如 `helper_bot`。\n    - `Bot??Bot*`：匹配形如 `Bot` + 任意两字符 + `Bot` + 任意后缀，例如 `Bot12BotX`、`BotA3Bot_something`。\n\n> 提示：如果你希望延续旧行为，让任意包含 `bot_` 的名字都视为机器人，请将该项配置为 `bot_`（不带通配符）。\n\n---\n\n## API 文档\n\n### `zbDataAPI.register_player_info_callback(func, list=[]) -> None`\n\n自动回传玩家的 NBT 信息（位置、维度、朝向等）。\n如果 `list` 为空（默认），监听所有NBT；否则仅对 `list` 中的NBT回传。\n\n> **参数**\n> \n> - `func(name: str, info: dict)`：回调函数，`name` 是玩家名，`info` 是该玩家的最新信息字典。\n> - `list: list`（可选）：要监听的NBT列表，默认 `[]`。\n\n---\n\n### `zbDataAPI.get_player_list() -> list`\n\n获取当前所有在线玩家的名字列表。\n\n```python\nplayers = zbDataAPI.get_player_list()\n```\n\n---\n\n### `zbDataAPI.register_player_list_callback(func) -> None`\n\n当有玩家上线或下线时触发。\n\n> **参数**\n> \n> - `func(player: str, current_list: list)`：回调函数，`player` 是发生变化的玩家名，`current_list` 是最新的在线玩家列表。\n\n---\n\n### `zbDataAPI.refresh_getpos() -> None`\n\n手动触发一次玩家信息拉取，与内部定时拉取逻辑等效。\n\n---\n\n## 开发与贡献\n\n1. Fork 本仓库\n2. 新建分支 `feature/xxx`\n3. 提交改动并发起 Pull Request\n\n欢迎提交 issue 和 PR，让这个 API 更加完善！\n\n---\n\n## 许可协议\n\n本项目遵循 GPLv3 许可，详情见 [LICENSE](https://github.com/zhongbai2333/zhongbais-Data-API/tree/main/./LICENSE) 文件。\n"
  },
  "introduction_urls": {
    "en_us": "https://raw.githubusercontent.com/zhongbai2333/zhongbais-Data-API/main/README.md",
    "zh_cn": "https://raw.githubusercontent.com/zhongbai2333/zhongbais-Data-API/main/README_zh.md"
  }
}